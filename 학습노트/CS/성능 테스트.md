https://www.youtube.com/watch?v=3cTn53dtzJI

### 성능 테스트란
API 요청이 많은 상황에서 서버가 어떻게 도착하는지 확인하는 테스트.

성능 테스트의 필요 이유
가용성(시스템이 서비스를 정상적으로 제공할 수 있는 상태)을 높일 수 있다.
설정한 목표치를 달성할 수 있다.

### 성능 테스트 지표
처리량(Throughput)과 응답 시간(Latency).
예) 처리량: 초당 1000건의 요청 처리
응답 시간: 모든 조회 요청을 1초 이내로 응답

처리량
처리량은 초당 처리하는 작업의 수를 의미한다.
RPS: 1초에 처리하는 HTTP 요청의 수. 

![[Pasted image 20231024195626.png]]
예) 500rps인 nginx, 200rps인 tomcat, 100rps인 mysql이 있다고 가정. 처리량은 몇 인가?
서브 시스템 중 가장 처리량이 낮은 부분으로 계산. 즉, 현재 시스템의 처리량은 100rps.

성능 개선 또는 시스템 확장으로 병목 구간을 해소할 수 있다. mysql 처리량을 300rps로 늘리면 tomcat이 병목 구간이 될 것.
병목 구간이 아닌 곳을 성능개선을 하면 의미가 없다.

응답시간
시스템이 요청을 받고 응답할 때까지의 시간. 
요청을 처리할 때까지 대기하는 시간도 응답 시간에 포함.
응답시간은 각 서브 시스템 응답 시간의 총합이다.
nginx 150ms, tomcat 500ms, mysql 100ms이라고 가정하면 총 응답 시간은 750ms.
응답시간은 어떤 부분을 개선하더라도 총 시스템 응답 시간에 영향을 미친다.

### 성능 테스트의 종류

스모크 테스트
최소한의 부하를 주어 시스템이 정상적으로 동작하는지 확인.

스파이크 테스트
사용량이 급증하는 상황에서 시스템이 견디는지, 성능에 문제가 없는지 확인.

부하 테스트
가장 일반적인 유형의 테스트다.
목표값에 해당되는 부하를 견딜 수 있는지 확인.

스트레스 테스트
시스템의 최대치에 해당되는 부하를 받았을 때 시스템이 어떻게 동작하는지 확인.

내구 테스트
평균 사용률을 이용해 일정 부하를 지속적으로 주며 시스템이 문제되는 지점을 확인.
흡수 테스트라고도 한다.

중단점 테스트
임계 지점을 찾기 위해 부하를 점진적으로 증가시키며 진행.


### 성능 테스트 도구

JMeter
Apache에서 만든 오픈 소스 소프트웨어, 자바로 구성.

장점: 많은 릴리즈와 개선 사항을 통해 고도로 유지, 관리.
		다양한 프로토콜 제공. HTTP, HTTPS, SOAP/REST 웹 서비스, FTP, DB(JDBC), Mail(SMTP, POP3, IMAP)
		다양한 플러그인 제공. 인텔리제이에서 사용 가능.
단점: 복잡한 스크립트와 가독성 떨어짐
		한 대의 Worker에서 사용할 수 있는 사용자 수가 매우 한정적. JMeter는 단계별 쓰레드 할당 방식. 쓰레드가 생성될 때마다 리소스를 할당해야 한다. 한 개의 Worker에서 천 개의 쓰레드를 할당하게 되면 무리가 발생.
		GUI 모드에서 많은 메모리 사용.
		기본적으로 제공되는 그래프의 가독성이 좋지 않음.

K6
Grafana Labs에서 만들었으며 JS로 구성되어 있다.

장점: 깔끔한 공식문서.
		비교적 간편한 스크립트.
		적은 메모리 사용.
		다양한 GUI 제공.
단점: 유료 클라우드 서비스.
		확장성의 한계. 대용량 트래픽에 사용 힘듦.


nGrinder
네이버에서 만든 오픈소스. 국내 개발자들이 많이 사용.

장점: 자바와 비슷한 스크립트 언어 지원.
		한국어 지원.
		완성도 높은 뼈대코드 지원.
		가독성 좋은 GUI.
단점: 분리된 프로세스. controller, agent 각각 따로 실행.
		테스트 스크립트 IDE 미지원.


### 테스트 계획 수립
계획 수립 시 필요한 것은 최소 레이턴시와 peak일 때의 사용 자 수이다.

보통 1초 이상 지연되면 7%, 3초 이상 지연되면 40%의 사용자가 이탈한다.
